---
title: "RNASeq-Proj1"
author: "Daniel Scheuermann"
date: "2024-01-31"
output: html_document
---

```{r initial_setup, include=TRUE}

knitr::opts_chunk$set(echo = TRUE)


# initial setup
library(DESeq2)
library(pheatmap)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(ggrepel)

```

```{r data_setup}

count_data <- read.csv("data/count_matrix.csv", header = TRUE, row.names = 1)

# here you can see the data set directly split into the treated and untreated samples.

# these two separate samples can be compared to show the effects that 'Pasilla' gene depletion has on gene expression.

colnames(count_data)

head(count_data)

# sample information

sample_info <- read.csv("data/design.csv", header = TRUE, row.names = 1)

colnames(sample_info)

head(sample_info)

# the factors here are single vs paired, treated vs untreated.

# setting factor levels
sample_info$Treatment <- factor(sample_info$Treatment)
sample_info$Sequencing <- factor(sample_info$Sequencing)

```

```{r DESeq2_setup}

# creating the deseq object
dds <- DESeqDataSetFromMatrix(countData = count_data, colData = sample_info, design = ~Sequencing + Treatment)

# treatment factor reference
dds$Treatment <- factor(dds$Treatment, level = c("untreated","treated"))

```

```{r data_manip}

# filtering the genes

# we are looking at genes whose count is greater than 10
keep <- rowSums(counts(dds)>10) >= min(table(sample_info$Treatment)) 

dds <- dds[keep,]

# identifying differentially expressed genes
dds <- DESeq(dds)
deseq_results <- results(dds)
deseq_results

# transfer the deseq results into a dataframe
deseq_results <- as.data.frame(deseq_results)
class(deseq_results)

# ordering
deseq_results <- deseq_results[order(deseq_results$pvalue),]

head(deseq_results)
```

```{r data_queries}

# looking specifically at FBgn0039155
deseq_results["FBgn0039155",]

# very low p value and negative log2FoldChange, so this gene is differentially expressed in low levels.

# testing whether or not the Pasilla gene is downregulated by the RNA treatment
deseq_results["FBgn0261552",]

# also low p value and negative log2FoldChange, so we can conclude this gene is downregulated.

```

